# Malware Analysis

The art of breaking apart malware/code to understand its functionality.

#1. - Virtual Machines
-----------------------------------------
- Windows 10 FlareVM: https://github.com/mandiant/flare-vm
    - FLARE VM is a freely available and open sourced Windows-based security distribution designed for reverse engineers, malware analysts, incident responders, forensicators, and penetration testers. Inspired by open-source Linux-based security distributions like Kali Linux, REMnux and others, FLARE VM delivers a fully configured platform with a comprehensive collection of Windows security tools such as debuggers, disassemblers, decompilers, static and dynamic analysis utilities, network analysis and manipulation, web assessment, exploitation, vulnerability assessment applications, and many others.

- Remnux VM: https://remnux.org/
    - REMnuxÂ® is a Linux toolkit for reverse-engineering and analyzing malicious software. REMnux provides a curated collection of free tools created by the community. Analysts can use it to investigate malware without having to find, install, and configure the tools.

#2. - Static Analysis
-----------------------------------------
The art of analysing malware without execution.

- Basic = looking at any and everything other than the assembly code.

- Advanced = looking at code in a disassembler usually Ghidra/IDA/Binja etc..

We look at the file type, file hash, strings (indicator of what we are dealing with), sections, imports (what API calls the process may make/non-presence could mean the application is packed) etc... Quick win/quick triage = chance of not repeating what fellow researchers have done.

### File Type

The type of file.

- Identify a file type on Windows

```
CyberChef https://gchq.github.io/CyberChef/#recipe=Detect_File_Type(true,true,true,true,true,true,true)
```

- Identify a file type on Linux

```
$ file <file>
```

### File Hash

Unique value that corresponds to the content of the file.

- Compute a SHA256 hash on Windows

```
PS C:\> Get-FileHash <file>
```

- Compute a SHA256 hash on Linux

```
$ sha256sum <file>
```

### Strings

Readable strings in a file.

- Extract the strings on Windows

```
PS C:\> strings <file>
```

- Extract the strings on Linux

```
$ pestr <file>
```

- Perform a strings comparison between two files using WinMerge (https://winmerge.org/?lang=en)

```
Select two files -> Right-click and select WinMerge 
```

### Additional Metadata

- PEStudio

```
https://www.winitor.com/
```

- CFF Explorer

```
https://ntcore.com/?page_id=388
```

#3. - Dynamic Analysis
-----------------------------------------
The art of analysing malware by execution.

- Basic = looking at any and everything other than the assembly code. Process Monitor logs, ProcDOT flow, Regshot, Wireshark.

- Advanced = executing code in a debugger usually x64dbg/winDbg/OllyDbg etc..

Quickly analyse the malware behaviour/quick overview of the malware by monitoring the OS = get access to artifacts more quickly rather than extracting them statically which can be a pain.
